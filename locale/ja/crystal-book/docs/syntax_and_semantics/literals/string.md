# æ–‡å­—åˆ— (String)

[String](http://crystal-lang.org/api/String.html) ã¯ UTF-8 æ–‡å­—ã®ä¸å¤‰ãªåˆ—ã‚’è¡¨ã—ã¾ã™ã€‚

é€šå¸¸ã€ãƒ€ãƒ–ãƒ«ã‚¯ã‚©ãƒ¼ãƒˆ (`"`) ã§å›²ã¾ã‚ŒãŸUTF-8ã§ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã•ã‚ŒãŸæ–‡å­—ã®ä¸¦ã³ã§æ–‡å­—åˆ—ãƒªãƒ†ãƒ©ãƒ«ã‚’è¨˜è¿°ã—ã¾ã™ã€‚

```crystal
"hello world"
```

## ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—æ–‡å­—

æ–‡å­—åˆ—ä¸­ã§ã¯ã€ãƒãƒƒã‚¯ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ã«ã‚ˆã‚‹åå‰ã¤ãã®ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã‚„ã‚³ãƒ¼ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®æ•°å€¤è¡¨ç¾ã«ã‚ˆã£ã¦ã€ç‰¹åˆ¥ãªæ–‡å­—ã‚’è¨˜è¿°ã§ãã¾ã™ã€‚

æ¬¡ã®ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ãŒæœ‰åŠ¹ã§ã™ã€‚
```crystal
"\""                  # double quote
"\\"                  # backslash
"\a"                  # alert
"\b"                  # backspace
"\e"                  # escape
"\f"                  # form feed
"\n"                  # newline
"\r"                  # carriage return
"\t"                  # tab
"\v"                  # vertical tab
"\377"                # octal ASCII character
"\xFF"                # hexadecimal ASCII character
"\uFFFF"              # hexadecimal unicode character
"\u{0}".."\u{10FFFF}" # hexadecimal unicode character
```

ãã®ä»–ã®æ–‡å­—ãŒãƒãƒƒã‚¯ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ã«ç¶šã„ãŸå ´åˆã€ãã®æ–‡å­—è‡ªèº«ã‚’è¡¨ã™ã‚‚ã®ã«ãªã‚Šã¾ã™ã€‚

ãƒãƒƒã‚¯ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ã«ç¶šãæœ€å¤§3ã¤ã®0ã‹ã‚‰7ã¾ã§ã®æ•°å€¤ã¯ã€8é€²æ•°ã«ã‚ˆã‚‹ã‚³ãƒ¼ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®è¨˜è¿°ã¨ãªã‚Šã¾ã™ã€‚

```crystal
"\101" # => "A"
"\123" # => "S"
"\12"  # => "\n"
"\1"   # ã‚³ãƒ¼ãƒ‰ãƒã‚¤ãƒ³ãƒˆ1ã®æ–‡å­—ãŒ1ã¤ã ã‘ã®æ–‡å­—åˆ—
```

ãƒãƒƒã‚¯ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ã«`u`ã‚’ç¶šã‘ã‚‹ã“ã¨ã§ãƒ¦ãƒ‹ã‚³ãƒ¼ãƒ‰ã®ã‚³ãƒ¼ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’è¨˜è¿°ã§ãã¾ã™ã€‚ãƒ¦ãƒ‹ã‚³ãƒ¼ãƒ‰ã®æ–‡å­—ã‚’è¡¨ç¾ã™ã‚‹ãŸã‚ã€ã¡ã‚‡ã†ã©4ã¤ã®16é€²æ•°ã®æ•°å€¤ã‹ (`\u0000` to `\uFFFF`) ã‹ã²ã’æ‹¬å¼§ã§å›²ã£ãŸ6ã¤ã¾ã§ã®16é€²æ•°ã®æ•°å€¤ãŒåˆ©ç”¨ã§ãã¾ã™ (`\u{0}` to `\u{10FFFF}`

```crystal
"\u0041"    # => "A"
"\u{41}"    # => "A"
"\u{1F52E}" # => "ğŸ”®"
```

1ã¤ã®ã²ã’æ‹¬å¼§ã®ä¸­ã«ã‚¹ãƒšãƒ¼ã‚¹ã§åŒºåˆ‡ã£ã¦è¤‡æ•°ã®ãƒ¦ãƒ‹ã‚³ãƒ¼ãƒ‰æ–‡å­—ãŒè¨˜è¿°ã§ãã¾ã™ã€‚

```crystal
"\u{48 45 4C 4C 4F}" # => "HELLO"
```

## æ–‡å­—åˆ—ã®è£œé–“

è£œé–“ã‚’ä¼´ã†æ–‡å­—åˆ—ãƒªãƒ†ãƒ©ãƒ«ã¯ã€æ–‡å­—åˆ—ã«å®Ÿè¡Œæ™‚ã«å±•é–‹ã•ã‚Œã‚‹å¼ã‚’åŸ‹ã‚è¾¼ã‚€ã“ã¨ãŒã§ãã¾ã™ã€‚

```crystal
a = 1
b = 2
"sum: #{a} + #{b} = #{a + b}" # => "sum: 1 + 2 = 3"
```

æ–‡å­—åˆ—ã®è£œé–“ã¯ [String#%](https://crystal-lang.org/api/String.html#%25%28other%29-instance-method) ã§ã‚‚å¯èƒ½ã§ã™ã€‚

ä»»æ„ã®å¼ã‚’æ–‡å­—åˆ—ã®è£œé–“ã¨ã—ã¦æ›¸ãã“ã¨ãŒã§ãã¾ã™ãŒã€å¯èª­æ€§ã‚’é«˜ã‚ã‚‹ãŸã‚ãã‚Œã‚‰ã®å¼ã¯å°ã•ãªã‚‚ã®ã«ä¿ã£ãŸã»ã†ãŒè‰¯ã„ã§ã™ã€‚

`#`ã‚’ãƒãƒƒã‚¯ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ã§ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã™ã‚‹ã‹ã€`%q()`ã®ã‚ˆã†ãªè£œé–“ã‚’è¨±å¯ã—ãªã„ã‚ˆã†ãªæ–‡å­—åˆ—ãƒªãƒ†ãƒ©ãƒ«ã‚’ä½¿ã†ã“ã¨ã§ã€è£œé–“ã‚’ç„¡åŠ¹ã«ã§ãã¾ã™ã€‚

```crystal
"\#{a + b}"  # => "#{a + b}"
%q(#{a + b}) # => "#{a + b}"
```

æ–‡å­—åˆ—ã®è£œé–“ã¯ [String::Builder](http://crystal-lang.org/api/String/Builder.html) ã‚’ä½¿ã„ã€ `#{...}` ã®ä¸­ã®å¼ã«å¯¾ã—ã¦ `Object#to_s(IO)` ã‚’å‘¼ã³å‡ºã™ã“ã¨ã§å®Ÿè£…ã•ã‚Œã¦ã„ã¾ã™ã€‚å¼`"sum: #{a} + #{b} = #{a + b}"`ã¯æ¬¡ã«ç­‰ã—ã„ã§ã™ã€‚

```crystal
String.build do |io|
  io << "sum: "
  io << a
  io << " + "
  io << b
  io << " = "
  io << a + b
end
```

# ãƒ‘ãƒ¼ã‚»ãƒ³ãƒˆæ–‡å­—åˆ—ãƒªãƒ†ãƒ©ãƒ«

ãƒ€ãƒ–ãƒ«ã‚¯ã‚©ãƒ¼ãƒˆã«ã‚ˆã‚‹æ–‡å­—åˆ—ãƒªãƒ†ãƒ©ãƒ«ã®ä»–ã«ã€Crystalã¯ãƒ‘ãƒ¼ã‚»ãƒ³ãƒˆè¨˜å· (`%`) ã¨åŒºåˆ‡ã‚Šæ–‡å­—ã®çµ„ã«ã‚ˆã‚‹æ–‡å­—åˆ—ãƒªãƒ†ãƒ©ãƒ«ã‚‚ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚æœ‰åŠ¹ãªåŒºåˆ‡ã‚Šæ–‡å­—ã¯ã€æ‹¬å¼§`()`ã€è§’æ‹¬å¼§`[]`ã€ã²ã’æ‹¬å¼§`{}`ã€ä¸‰è§’æ‹¬å¼§`<>`ãã—ã¦ãƒ‘ã‚¤ãƒ—æ–‡å­—`||`ã§ã™ã€‚ãƒ‘ã‚¤ãƒ—æ–‡å­—ã‚’é™¤ã„ã¦ã€ã™ã¹ã¦ã®åŒºåˆ‡ã‚Šæ–‡å­—ã¯ãƒã‚¹ãƒˆã«å¿œã˜ã¦é©åˆ‡ã«å‡¦ç†ã•ã‚Œã¾ã™ã€‚

ãƒ€ãƒ–ãƒ«ã‚¯ã‚©ãƒ¼ãƒˆã‚’å«ã‚€ã‚ˆã†ãªæ–‡å­—åˆ—ã‚’æ›¸ãã®ã«ã“ã‚Œã‚‰ã®ãƒªãƒ†ãƒ©ãƒ«ã¯ãŠæ‰‹è»½ã§ã™ã€‚

```crystal
%(hello ("world")) # => "hello (\"world\")"
%[hello ["world"]] # => "hello [\"world\"]"
%{hello {"world"}} # => "hello {\"world\"}"
%<hello <"world">> # => "hello <\"world\">"
%|hello "world"|   # => "hello \"world\""
```

`%q`ã§è¨˜è¿°ã•ã‚Œã‚‹æ–‡å­—åˆ—ãƒªãƒ†ãƒ©ãƒ«ã¯ã€æ–‡å­—åˆ—ã®è£œé–“ã¨ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã‚’å—ã‘ä»˜ã‘ã¾ã›ã‚“ã€‚ã¾ãŸ`%Q`ã¯`%`ã¨åŒã˜æ„å‘³ã‚’æŒã¡ã¾ã™ã€‚

```crystal
name = "world"
%q(hello \n #{name}) # => "hello \\n \#{name}"
%Q(hello \n #{name}) # => "hello \n world"
```

## ãƒ‘ãƒ¼ã‚»ãƒ³ãƒˆæ–‡å­—åˆ—é…åˆ—ãƒªãƒ†ãƒ©ãƒ«

1ã¤ã®æ–‡å­—åˆ—ã‚’è¡¨ã™ãƒªãƒ†ãƒ©ãƒ«ã®ä»–ã«ã€æ–‡å­—åˆ—ã®[é…åˆ—](https://crystal-lang.org/api/Array.html)ã‚’è¡¨ã™ãƒ‘ãƒ¼ã‚»ãƒ³ãƒˆãƒªãƒ†ãƒ©ãƒ«ãŒã‚ã‚Šã¾ã™ã€‚ãã‚Œã¯`%w`ã¨åŒºåˆ‡ã‚Šæ–‡å­—ã®çµ„ã«ã‚ˆã£ã¦è¨˜è¿°ã—ã¾ã™ã€‚æœ‰åŠ¹ãªåŒºåˆ‡ã‚Šæ–‡å­—ã¯[ãƒ‘ãƒ¼ã‚»ãƒ³ãƒˆæ–‡å­—åˆ—ãƒªãƒ†ãƒ©ãƒ«](#percent-string-literals)ã®ã¨ãã¨åŒã˜ã§ã™ã€‚

```crystal
%w(foo bar baz)  # => ["foo", "bar", "baz"]
%w(foo\nbar baz) # => ["foo\\nbar", "baz"]
%w(foo(bar) baz) # => ["foo(bar)", "baz"]
```

Note that literal denoted by `%w` does not apply interpolation nor escapes except spaces. ã‚‚ã¡ã‚ã‚“ã€ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã•ã‚ŒãŸ1ã¤ã®ã‚¹ãƒšãƒ¼ã‚¹ (` `) ã§ã¯æ–‡å­—åˆ—ã¯åŒºåˆ‡ã‚‰ã‚Œã¾ã›ã‚“ã€‚

```crystal
%w(foo\ bar baz) # => ["foo bar", "baz"]
```

## è¤‡æ•°è¡Œã®æ–‡å­—åˆ—

ä»»æ„ã®æ–‡å­—åˆ—ãƒªãƒ†ãƒ©ãƒ«ã¯è¤‡æ•°è¡Œã«ã¾ãŸãŒã£ã¦è¨˜è¿°ã§ãã¾ã™ã€‚

```crystal
"hello
      world" # => "hello\n      world"
```

ä¸Šã®ä¾‹ã§ã¯ã€å…ˆé ­ã¨æœ«å°¾ã®ç©ºç™½ã€ãŠã‚ˆã³æ”¹è¡ŒãŒçµæœã®æ–‡å­—åˆ—ã«ã‚‚å…¥ã£ã¦ã„ã‚‹ã“ã¨ã«æ³¨ç›®ã—ã¦ãã ã•ã„ã€‚ã“ã‚Œã‚’é˜²ããŸã‚ã«ã€æ–‡å­—åˆ—ãƒªãƒ†ãƒ©ãƒ«ã‚’è¡Œæ¯ã«åˆ†å‰²ã—ã¦ã€ãƒãƒƒã‚¯ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ã§çµåˆã™ã‚‹ã¨ã„ã†æ‰‹æ®µã‚’å–ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

```crystal
"hello " \
"world, " \
"no newlines" # same as "hello world, no newlines"
```

ã‚‚ã—ãã¯ã€ãƒãƒƒã‚¯ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ã«æ”¹è¡Œã‚’ç¶šã‘ãŸã‚‚ã®ã‚’æ–‡å­—åˆ—ä¸­ã«è¿½åŠ ã™ã‚‹ã€ã¨ã„ã†æ‰‹æ®µã‚‚ã‚ã‚Šã¾ã™ã€‚

```crystal
"hello \
     world, \
     no newlines" # same as "hello world, no newlines"
```

ã“ã®å ´åˆã€å…ˆé ­ã®ç©ºç™½ãŒçµæœã®æ–‡å­—åˆ—ã«å«ã¾ã‚Œã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

## ãƒ’ã‚¢ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

*ãƒ’ã‚¢ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ*ãªã„ã—*heredoc*ã¯è¤‡æ•°è¡Œã«ã¾ãŸãŒã‚‹æ–‡å­—åˆ—ã®ä¾¿åˆ©ãªæ›¸ãæ–¹ã§ã™ã€‚
ãƒ’ã‚¢ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯`<<-`ã¨ãã‚Œã«ç¶šãã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆã¨æ•°å­— (ã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢ã‚‚å«ã‚ã‚‹ã“ã¨ãŒã§ãã‚‹) ã®ä¸¦ã³ã®è­˜åˆ¥å­ã«ã‚ˆã£ã¦è¨˜è¿°ã•ã‚Œã¾ã™ã€‚The heredoc starts in the following line and ends with the next line that contains *only* the heredoc identifier, optionally preceeded by whitespace.

```crystal
<<-XML
<parent>
  <child />
</parent>
XML
```

æœ€å¾Œã®è¡Œã®ãƒ’ã‚¢ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®è­˜åˆ¥å­ã®å‰ã®ç©ºç™½ã®å€‹æ•°åˆ†ã ã‘ã€ãƒ’ã‚¢ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®å†…å®¹ã‹ã‚‰å…ˆé ­ã®ç©ºç™½æ–‡å­—ãŒå‰Šé™¤ã•ã‚Œã¾ã™ã€‚

```crystal
<<-STRING # => "Hello\n  world"
  Hello
    world
  STRING

<<-STRING # => "  Hello\n    world"
    Hello
      world
  STRING
```

After the heredoc identifier, and in that same line, anything that follows continues the original expression that came before the heredoc. It's as if the end of the starting heredoc identifier is the end of the string. However, the string contents come in subsequent lines until the ending heredoc idenfitier which must be on its own line.

```crystal
<<-STRING.upcase # => "HELLO"
hello
STRING

def upcase(string)
  string.upcase
end

upcase(<<-STRING) # => "HELLO WORLD"
  Hello World
  STRING
```

If multiple heredocs start in the same line, their bodies are read sequentially:

```cr
print(<<-FIRST, <<-SECOND) # prints "HelloWorld"
  Hello
  FIRST
  World
  SECOND
```

ãƒ’ã‚¢ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ä¸­ã§ã¯ä¸€èˆ¬çš„ã«è£œé–“ã¨ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ãŒæœ‰åŠ¹ã«ãªã£ã¦ã„ã¾ã™ã€‚

ãƒ’ã‚¢ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ä¸­ã§è£œé–“ã‚„ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã‚’ç¦æ­¢ã—ãŸã„å ´åˆã€ãƒ’ã‚¢ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå†’é ­ã®è­˜åˆ¥å­ã‚’ã‚·ãƒ³ã‚°ãƒ«ã‚¯ã‚©ãƒ¼ãƒˆã§å›²ã£ã¦ãã ã•ã„ã€‚

```crystal
<<-'HERE' # => "hello \\n \#{world}"
  hello \n #{world}
  HERE
```
